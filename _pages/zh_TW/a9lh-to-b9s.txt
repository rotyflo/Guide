---
title: "升級 A9LH 至 B9S"
---

{% include toc title="條目內容" %}

### 必讀事項

本頁面適用於想更新至 boot9strap 且已安裝 arm9loaderhax 的使用者使用。

未來所有的 Luma3DS 版本都將以 `.firm` 形式推出，且此格式僅相容於 boot9strap 以及 sighax。 也就是說，如果您想要繼續使用最新版的 Luma3DS，您應透過本章節來更新您的主機。

To use the [magnet](https://wikipedia.org/wiki/Magnet_URI_scheme) links on this page, you will need a torrent client like [Deluge](http://dev.deluge-torrent.org/wiki/Download).

若要解壓該頁面中的`.7z`檔案，您將需要一個壓縮檔管理員，如 [7-Zip](http://www.7-zip.org/) 或 [The Unarchiver](https://theunarchiver.com/)。

如果您先前有在 Luma3DS 中設置了安全 PIN 碼，除非您暫時將其關閉，否則 SafeB9SInstaller 安裝包將會出現『OTP Crypto Fail』的錯誤訊息 (您可以在更新後重新設定 PIN 碼)。
{: .notice--warning}

{% capture notice-1 %}
近日有許多的自製韌體用戶已經被任天堂封殺，幾乎所有的線上功能都被禁止使用。 為了自保，請在遵循本教學前進行以下防護措施：

1. 進入『系統設定 (System Settings)』、『網路設定 (Internet Settings)』、『SpotPass』、『回傳系統訊息 (Sending of System Information)』
1. 禁用『回傳系統訊息 (Sending of System Information)』
1. 退出系統設定
1. 開啟您的好友清單 (HOME 主選單中最上方的[橘色笑臉圖示]({{ "/images/friend-list-icon.png" | absolute_url }}))
  + 如果您遇到錯誤訊息且從清單中被踢回主選單，那麼可能您已將好友清單設定關閉或您的主機無法連線至任天堂伺服器 (您可能已被封殺或網路連線之問題)
1. 進入好友選單設定、『好友提示設定 (Friend Notification Settings)』、『顯示正在遊玩的遊戲 (Show friends what you're playing)』
1. 禁用『顯示正在遊玩的遊戲 (Show friends what you're playing)』
1. 退出好友清單

{% endcapture %}

<div class="notice--danger">{{ notice-1 | markdownify }}</div>

### 必備項目

請注意，以下所需的 `secret_sector.bin` 與在各式 `data_input.zip` 版本中所見的檔案相同。 如果您已經有了那個檔案，您可以直接使用它而不必再重新下載一個新的。
{: .notice--info}

請注意，只有在使用 New 3DS 時，`secret_sector.bin` 是用來還原 arm9loaderhax 漏洞用的，這也就是為什麼在原廠主機上安裝 boot9strap 時不會用到它。 若您的主機不是 New 3DS 的機型，您則不需要使用 `secret_sector.bin`。
{: .notice--info}

* <i class="fa fa-magnet" aria-hidden="true" title="這是個種子連結。 Use a torrent client to download the file."></i> - **New 3DS Users Only:** [secret_sector.bin](magnet:?xt=urn:btih:15a3c97acf17d67af98ae8657cc66820cc58f655&dn=secret_sector.bin&tr=udp%3A%2F%2F9.rarbg.to%3A2710%2Fannounce&tr=udp%3A%2F%2Fbt.xxx-tracker.com%3A2710%2Fannounce&tr=udp%3A%2F%2Fexodus.desync.com%3A6969%2Fannounce&tr=udp%3A%2F%2Fmgtracker.org%3A6969%2Fannounce&tr=udp%3A%2F%2Fopen.demonii.si%3A1337%2Fannounce&tr=udp%3A%2F%2Fpublic.popcorn-tracker.org%3A6969%2Fannounce&tr=udp%3A%2F%2Fthetracker.org%3A80%2Fannounce&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.cypherpunks.ru%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.ds.is%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.internetwarriors.net%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.mg64.net%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.open-internet.nl%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.port443.xyz%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.qt.is%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.tiny-vps.com%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Ftracker.vanitycore.co%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker-2.msm8916.com%3A6969%2Fannounce)
* 最新版的 [Luma3DS](https://github.com/AuroraWright/Luma3DS/releases/latest) *(`.7z` 檔案)*
* 7.0.5 版的 [Luma3DS](https://github.com/AuroraWright/Luma3DS/releases/tag/v7.0.5) *(`.7z` 檔案)*
* 最新版的 [SafeB9SInstaller](https://github.com/d0k3/SafeB9SInstaller/releases/latest)
* 最新版的 [boot9strap](https://github.com/SciresM/boot9strap/releases/latest) *(正常版的 boot9strap；非 `devkit` 或 `ntr` 檔案)*
* 最新版的 [Anemone3DS](https://github.com/astronautlevel2/Anemone3DS/releases/latest) *(`.cia` 檔案)*
* The latest release of [Checkpoint](https://github.com/FlagBrew/Checkpoint/releases/latest) *(the `.cia` file)*
* 最新版的 [Homebrew Launcher Wrapper](https://github.com/mariohackandglitch/homebrew_launcher_dummy/releases/latest)
* 最新版的 [GodMode9](https://github.com/d0k3/GodMode9/releases/latest)
* 最新版的 [DSP1](https://github.com/zoogie/DSP1/releases/latest)
* 最新版的 [FBI 管理器](https://github.com/Steveice10/FBI/releases/latest) *(`.cia` 及 `.3dsx` 檔案)*
* 最新版本的 [ctr-no-timeoffset](https://github.com/ihaveamac/ctr-no-timeoffset/releases/latest)
* 最新版的 [Luma3DS Updater](https://github.com/KunoichiZ/lumaupdate/releases/latest) *(`.cia` 檔案)*
* 最新版的 [Homebrew Launcher](https://github.com/fincs/new-hbmenu/releases/latest)

### 操作說明

#### 第一節 — 準備工作

在本節中，請覆蓋所有 SD 卡中可能相衝的檔案。
{: .notice--info}

1. 關閉您的主機
1. 將 SD 卡插入至電腦中
1. 將 `boot.3dsx` 複製到 SD 卡根目錄中
1. 在 SD 卡的根目錄底下建立一個新資料夾 `3ds`
1. 在 SD 卡的根目錄底下，建立一個新資料夾 `cias`
1. 將 `ctr-no-timeoffset.3dsx` 複製到 SD 卡中的 `/3ds/` 資料夾底下
1. 將 `FBI.3dsx` 複製到 SD 卡中的 `/3ds/` 資料夾底下
1. 將 `Homebrew_Launcher.cia` 複製到 SD 卡中 `/cias/` 資料夾底下
1. 複製 `lumaupdater.cia` 檔案至 SD 卡上的 `/cias/` 資料夾中
1. 將 `FBI.cia` 複製到 SD 卡中 `/cias/` 資料夾底下
1. 將 `DSP1.cia` 複製到 SD 卡中 `/cias/` 資料夾底下
1. 將 `Anemone3DS.cia` 複製到 SD 卡中 `/cias/` 資料夾底下
1. 將 `Checkpoint.cia` 複製到 SD 卡中 `/cias/` 資料夾底下
1. 解壓最新版 Luma3DS `.7z` 內的 `boot.firm` 到 SD 卡的根目錄底下
1. 解壓 v7.0.5 Luma3DS `.7z` 內的 `arm9loaderhax.bin` 到 SD 卡的根目錄底下
1. 刪除所有在您 SD 卡 `/luma/payloads/` 資料夾中的 `.bin` payload 檔案，因為它們將無法與 boot9strap 版本的 Luma3DS 相容
1. 解壓 GodMode9 `.zip` 中的 `GodMode9.firm` 檔案到 SD 卡的 `/luma/payloads/` 資料夾中
1. 解壓 GodMode9 `.zip` 中的 `gm9` 資料夾到 SD 卡的根目錄底下
1. 解壓 SafeB9SInstaller`.zip` 中的 `SafeB9SInstaller.bin` 到 SD 中的 `/luma/payloads/` 下
1. 在 SD 卡的根目錄底下建立一個新的資料夾 `boot9strap`
1. 解壓 boot9strap `.zip` 的 `boot9strap.firm` 及 `boot9strap.firm.sha` 檔案至 SD 卡的 `/boot9strap/` 資料夾中
1. **僅限 New 3DS 使用者：**將 `secret_sector.bin` 複製到 SD 卡的 `/boot9strap/` 資料夾中

    ![]({{ "/images/screenshots/a9lh-to-b9s-file-layout.png" | absolute_url }})
    {: .notice--info}

1. 將 SD 卡插回主機中

#### 第二節 — 安裝 boot9strap

1. 開機時，按住『Start』鍵啟動 SafeB9SInstaller
  + 若您看到的選單為 Luma 設定選單而非 SafeB9SInstaller，請按下『Start』鍵並將您的主機關機並再試一次
  + 如果您在此步驟遇到了錯誤訊息，請試試看使用新的 SD 卡或將它格式化 (請先自行備份檔案)
1. 等待所有安全性檢查完畢
  + 如果您遇到『OTP Crypto Fail』的錯誤訊息，請下載 <i class="fa fa-magnet" aria-hidden="true" title="這是個種子連結。 Use a torrent client to download the file."></i> - [aeskeydb.bin](magnet:?xt=urn:btih:d25dab06a7e127922d70ddaa4fe896709dc99a1e&dn=aeskeydb.bin&tr=udp%3A%2F%2F9.rarbg.to%3A2710%2Fannounce&tr=udp%3A%2F%2Fbt.xxx-tracker.com%3A2710%2Fannounce&tr=udp%3A%2F%2Fexodus.desync.com%3A6969%2Fannounce&tr=udp%3A%2F%2Fmgtracker.org%3A6969%2Fannounce&tr=udp%3A%2F%2Fopen.demonii.si%3A1337%2Fannounce&tr=udp%3A%2F%2Fpublic.popcorn-tracker.org%3A6969%2Fannounce&tr=udp%3A%2F%2Fthetracker.org%3A80%2Fannounce&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.cypherpunks.ru%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.ds.is%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.internetwarriors.net%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.mg64.net%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.open-internet.nl%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.port443.xyz%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.qt.is%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.tiny-vps.com%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Ftracker.vanitycore.co%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker-2.msm8916.com%3A6969%2Fannounce), then put it in the `/boot9strap/` folder on your SD card and try again
1. 出現提示時，輸入提示的按鍵組合以安裝 boot9strap
1. 過程結束後，按下『A』重啟主機
  + 如果您的主機在啟動時直接關機，請確保您已經將 Luma3DS `.7z` 中的 `boot.firm` 複製到您的 SD 卡根目錄中

#### 第三節 — 設定 Luma3DS

1. 在 Luma3DS 設定選單中，透過『A』及方向鍵來啟用下列選項：    
  + **『Show NAND or user string in System Settings』**
1. 按『Start』鍵以存檔並重新啟動系統

#### 第四節 — 更新系統

如果您在依循本手冊的步驟前，已經改機完且安裝了 EmuNAND，並且想把您原來 EmuNAND 的資料轉移到新的 SysNAND 自製韌體中，請在開始本部分操作之前先按照[移植EmuNAND](move-emunand)一節進行。
{: .notice--info}

1. 到主機主選單中更新您的主機，到『系統設置(System Settings)』、『其他設置(Other Settings)』底下選擇『系統更新(System Update)』
  + 在安裝 B9S + Luma 後系統更新是沒問題的
  + 如果過程中出現錯誤，試試到 DNS 設定底下將設定改成『自動 (auto)』
  + 如果錯誤持續，請進行 [CTRTransfer](ctrtransfer)，並再試一次

#### Section V - Homebrew Launcher

1. Launch the Download Play application (this [icon]({{ "/images/download-play-icon.png" | absolute_url }})
1. 同時按下『L』+『下』+『Select』鍵以啟動 Rosalina 選單
1. 選擇『Miscellaneous options』
1. 選擇『Switch the hb. title to the current app.』
1. 按『B』繼續
1. 按『B』回到 Rosalina 主選單
1. 按『B』退出 Rosalina 選單
1. 按『Home』鍵，並關閉『下載通信 (Download Play)』程式
1. 啟動『下載通信 (Download Play)』程式
1. 您的主機應該就會啟動 Homebrew Launcher 了
1. 透過 Homebrew 清單啟動 ctr-no-timeoffset
1. 按『A』選擇將數值設成 0
  + 這將會把系統時間設為與 RTC 相同的數值
1. 按「Start」鍵回到 Homebrew Launcher 中
1. 於 Homebrew 清單內啟動 FBI 管理器

#### Section VI - Installing CIAs

1. 移動至 `SD` -> `cias`
1. 選擇『\<current directory>』
1. 選擇『Install and delete all CIAs』(安裝並刪除所有的 CIA 檔)，並按下『A』確認
1. 按『Home』鍵，並關閉『下載通信 (Download Play)』程式

#### Section VII - DSP Dump

1. 啟動 DSP1
1. 當它處理完畢後，按下『B』將程式刪除並回到主選單

#### Section VIII - CTRNAND Luma3DS

1. 關閉您的主機
1. 開機時按住『Start』鍵啟動 GodMode9
1. 當提示重要檔案備份時，按下『A』繼續，並在完畢後按下『A』繼續
1. 當提示修正 RTC 日期及時間時，按『A』繼續並設定日期及時間，再按『A』繼續
1. 按『Home』鍵以叫出主選單
1. 選擇『Scripts...』
1. 選擇『GM9Megascript』
1. 選擇『Scripts from Plailect's Guide』
1. 選擇『Setup Luma3DS to CTRNAND』
1. 當提示時，按下『A』繼續
1. 按『A』解鎖 SysNAND (lvl2) 的寫入保護，然後按下提示的按鍵組合
1. 按『A』 繼續

#### Section IX - Cleanup SD Card

1. 選擇『Cleanup SD Card』
1. 當提示時，按下『A』繼續
1. 按『A』 繼續
1. 按『B』回到主選單

#### Section X - Backup Essential Files

1. 選擇『Backup Options』
1. 選擇『SysNAND Backup』
1. 按 『A』 確認
  + 此過程將花費一些時間
  + 若您遇見錯誤訊息，請確保您的 SD 卡至少有 1.3GB 的剩餘空間。
1. 按『A』 繼續
1. 按『B』回到主選單
1. 選擇『Exit』
1. 當提示時，按下『A』取消檔案寫入鎖定
1. Navigate to `[M:] MEMORY VIRTUAL`
1. Press (A) on `boot9.bin` to select it
1. Select "Copy to 0:/gm9/out"
1. 按『A』 繼續
1. 按『B』回到主選單
1. 同時按住『R』及『B』以卸除 SD 卡
1. 將 SD 卡插入至電腦中
1. Copy `<date>_<serialnumber>_sysnand_###.bin`, `essential.exefs`, and `boot9.bin` from the `/gm9/out/` folder on your SD card to a safe location on your computer
  + 建議備份至各個不同的地方(比如雲端硬碟中)
  + 這些備份檔案可於未來您磚機時用來修復系統檔案
1. 在複製完畢後，從 SD 卡的 `/gm9/out/` 資料夾中刪除 `<date>_<serialnumber>_sysnand_###.bin` 及 `<date>_<serialnumber>_sysnand_###.bin.sha`
1. 將 SD 卡插回主機中
1. 按下『Start』鍵重啟您的主機

___

{% capture notice-10 %}
您現在可以透過 Luma3DS Updater 來更新您主機中的 Luma3DS，只要將它開啟，再按下『A』即可。

這跟系統更新是不一樣的；這只會下載並解壓最新的 Luma3DS 檔案。

這只會更新 SD 卡上的 Luma3DS 檔案。 如果您在拔除 SD 卡的情況下開機，它則會透過您放在 CTRNAND 裡的 Luma3DS 開機。    
{% endcapture %}

<div class="notice--info">{{ notice-10 | markdownify }}</div>

{% capture notice-6 %}   
您的主機現在在預設情況下將會自動於開機時啟動基於 SysNAND 的 Luma3DS 自製韌體。    

您現在可以在開機時透過按住『Select』鍵進入 Luma3DS 的設定選單。    

您現在可以在開機時透過按住『Start』鍵啟動 Luma3DS 連環加載選單(請注意，它只有在偵測到多個 payload 檔案時，才會顯示 Luma3DS 連環加載選單)。    

您現在可以在開機時透過按住『Start』+『Select』+『X』轉儲您主機的 ARM11 bootrom (`boot11.bin`)、ARM9 bootrom (`boot9.bin`)、以及您主機特有的 OTP 金鑰 (`OTP.bin`) 到 SD 卡的 `/boot9strap/` 資料夾中 (請注意，本過程中將不會出現任何的提示或訊息)。    

您現在可以在開機情況下，透過『L』+『下』+『Select』鍵啟動 Luma3DS 所內建的 Rosalina 選單。 有關所有 Rosalina 相關之功能，請見 [Luma3DS v8.0 更新條目](https://github.com/AuroraWright/Luma3DS/releases/tag/v8.0)。
{% endcapture %}

<div class="notice--info">{{ notice-6 | markdownify }}</div>

{% capture notice-6 %}   
如果您想要升級到較大的 SD 卡，您只需要將您的 SD 卡格式化為 FAT32 並從您舊的 SD 卡中複製其內容至新的卡中即可。    

如果您的 SD 卡大於 32GB，那麼您得使用不同的工具以格式化該記憶卡；工具例如 Windows 上的 [guiformat](http://www.ridgecrop.demon.co.uk/index.htm?guiformat.htm)、Linux 上的 [gparted](http://gparted.org/download.php)、Mac 上的[磁碟工具程式](https://support.apple.com/en-gb/guide/disk-utility/format-a-disk-for-windows-computers-dskutl1010/mac)。    
{% endcapture %}

<div class="notice--info">{{ notice-6 | markdownify }}</div>

如果您想使用 [NTR 自製韌體](https://github.com/44670/BootNTR/)，請安裝 [BootNTR Selector](https://gbatemp.net/threads/432911/).
{: .notice--info}

有關如何更改主機區碼，請見[區碼變更](region-changing)。
{: .notice--success}

有關使用 GodMode9 的各式功能的詳細資訊，請見[如何使用 GodMode9](godmode9-usage)。
{: .notice--success}

有關如何使用 Luma3DS 的各項功能，請見[他們的 wiki](https://github.com/AuroraWright/Luma3DS/wiki/Options-and-usage)。
{: .notice--success}

有關如何安裝自訂主題、及啟動畫面，請見 [Theme Plaza](https://themeplaza.eu/)。
{: .notice--success}